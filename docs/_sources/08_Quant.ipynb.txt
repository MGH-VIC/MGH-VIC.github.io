{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "220d3d5b-2d1a-4904-ad7e-e0f1b5db94f0",
   "metadata": {},
   "source": [
    "# Single Cell Quantification\n",
    "\n",
    "-Single cell quantification with skimage"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1e1c2a59-fedd-488d-b00b-86b712d23c38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'/opt/conda/envs/miaaim-dev/bin/python'"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# HDI quantification\n",
    "# import custom modules\n",
    "from miaaim.quant.quantification import HDIquantification\n",
    "\n",
    "# import external modules\n",
    "from pathlib import Path\n",
    "import pandas as pd\n",
    "import os\n",
    "import numpy as np\n",
    "import skimage.io\n",
    "import nibabel as nib\n",
    "from tqdm import tqdm\n",
    "\n",
    "import skimage.filters.edges as ed\n",
    "import scipy.ndimage\n",
    "from miaaim.io.imread import _import\n",
    "\n",
    "# check versions and environment executable\n",
    "import sys\n",
    "sys.version\n",
    "sys.executable"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "3de40395-f506-4e30-8bb2-e6638149c374",
   "metadata": {},
   "outputs": [],
   "source": [
    "# n-dimensional filter weights\n",
    "SOBEL_EDGE = np.array([1, 0, -1])\n",
    "SOBEL_SMOOTH = np.array([1, 2, 1]) / 4\n",
    "\n",
    "def sobel(image, mask=None, *, axis=None, mode='reflect', cval=0.0):\n",
    "    \"\"\"Find edges in an image using the Sobel filter.\n",
    "    Parameters\n",
    "    ----------\n",
    "    image : array\n",
    "        The input image.\n",
    "    mask : array of bool, optional\n",
    "        Clip the output image to this mask. (Values where mask=0 will be set\n",
    "        to 0.)\n",
    "    axis : int or sequence of int, optional\n",
    "        Compute the edge filter along this axis. If not provided, the edge\n",
    "        magnitude is computed. This is defined as::\n",
    "            sobel_mag = np.sqrt(sum([sobel(image, axis=i)**2\n",
    "                                     for i in range(image.ndim)]) / image.ndim)\n",
    "        The magnitude is also computed if axis is a sequence.\n",
    "    mode : str or sequence of str, optional\n",
    "        The boundary mode for the convolution. See `scipy.ndimage.convolve`\n",
    "        for a description of the modes. This can be either a single boundary\n",
    "        mode or one boundary mode per axis.\n",
    "    cval : float, optional\n",
    "        When `mode` is ``'constant'``, this is the constant used in values\n",
    "        outside the boundary of the image data.\n",
    "    Returns\n",
    "    -------\n",
    "    output : array of float\n",
    "        The Sobel edge map.\n",
    "    See also\n",
    "    --------\n",
    "    sobel_h, sobel_v : horizontal and vertical edge detection.\n",
    "    scharr, prewitt, farid, skimage.feature.canny\n",
    "    References\n",
    "    ----------\n",
    "    .. [1] D. Kroon, 2009, Short Paper University Twente, Numerical\n",
    "           Optimization of Kernel Based Image Derivatives.\n",
    "    .. [2] https://en.wikipedia.org/wiki/Sobel_operator\n",
    "    Examples\n",
    "    --------\n",
    "    >>> from skimage import data\n",
    "    >>> from skimage import filters\n",
    "    >>> camera = data.camera()\n",
    "    >>> edges = filters.sobel(camera)\n",
    "    \"\"\"\n",
    "    output = ed._generic_edge_filter(image, smooth_weights=SOBEL_SMOOTH,\n",
    "                                  axis=axis, mode=mode, cval=cval)\n",
    "    output = ed._mask_filter_result(output, mask)\n",
    "    return output\n",
    "\n",
    "\n",
    "def sobel_h(image, mask=None):\n",
    "    \"\"\"Find the horizontal edges of an image using the Sobel transform.\n",
    "    Parameters\n",
    "    ----------\n",
    "    image : 2-D array\n",
    "        Image to process.\n",
    "    mask : 2-D array, optional\n",
    "        An optional mask to limit the application to a certain area.\n",
    "        Note that pixels surrounding masked regions are also masked to\n",
    "        prevent masked regions from affecting the result.\n",
    "    Returns\n",
    "    -------\n",
    "    output : 2-D array\n",
    "        The Sobel edge map.\n",
    "    Notes\n",
    "    -----\n",
    "    We use the following kernel::\n",
    "      1   2   1\n",
    "      0   0   0\n",
    "     -1  -2  -1\n",
    "    \"\"\"\n",
    "    return sobel(image, mask=mask, axis=0)\n",
    "\n",
    "\n",
    "def sobel_v(image, mask=None):\n",
    "    \"\"\"Find the vertical edges of an image using the Sobel transform.\n",
    "    Parameters\n",
    "    ----------\n",
    "    image : 2-D array\n",
    "        Image to process.\n",
    "    mask : 2-D array, optional\n",
    "        An optional mask to limit the application to a certain area.\n",
    "        Note that pixels surrounding masked regions are also masked to\n",
    "        prevent masked regions from affecting the result.\n",
    "    Returns\n",
    "    -------\n",
    "    output : 2-D array\n",
    "        The Sobel edge map.\n",
    "    Notes\n",
    "    -----\n",
    "    We use the following kernel::\n",
    "      1   0  -1\n",
    "      2   0  -2\n",
    "      1   0  -1\n",
    "    \"\"\"\n",
    "    return sobel(image, mask=mask, axis=1)\n",
    "\n",
    "\n",
    "def per_channel_sobel(arr, nms, sigma=2):\n",
    "    \"\"\"Sobel filter over each channel of 2D imaging data.\n",
    "\n",
    "    Parameters\n",
    "    ----------\n",
    "    arr: numpy.ndarray with 3 axes.\n",
    "        Input image consisting of c,y,x axes.\n",
    "\n",
    "    nms: list\n",
    "        Indicates names of markers in the array indexed in position 0.\n",
    "\n",
    "    out_dir: os path\n",
    "        Output directory to store resulting image.\n",
    "        \n",
    "    sigma: int\n",
    "        Gaussian smoothing parameter.\n",
    "    \"\"\"\n",
    "    # get sizes of image\n",
    "    x,y,c = arr.shape\n",
    "    # create array to store results\n",
    "    grad_array = np.zeros((x,y,c,2))\n",
    "    grad_mag_array = np.zeros((x,y,c))\n",
    "    # create indexer\n",
    "    i = 0\n",
    "    # iterate through each gene\n",
    "    for g in tqdm(nms, desc='Computing image gradients'):\n",
    "        # get gene\n",
    "        C_ = arr[:,:,i]\n",
    "        # reshape\n",
    "        C = C_.reshape(C_.shape[0],C_.shape[1])\n",
    "        # apply gaussian smoothing\n",
    "        if sigma is not None:\n",
    "            # smooth\n",
    "            C = scipy.ndimage.gaussian_filter(C,sigma=sigma)\n",
    "\n",
    "        # compute gradient approximation with sobel filter\n",
    "        grad_h = sobel_h(C)\n",
    "        grad_v = sobel_v(C)\n",
    "        # compute magnitude\n",
    "        sobel_mag = np.sqrt(sum([i**2 for i in [grad_h,grad_v]])/2)\n",
    "\n",
    "        # update output array with gradients\n",
    "        grad_array[:,:,i,0] = grad_h\n",
    "        grad_array[:,:,i,1] = grad_v\n",
    "        # update output array of gradient magnitude\n",
    "        grad_mag_array[:,:,i] = sobel_mag\n",
    "\n",
    "        # update indexer\n",
    "        i = i + 1     \n",
    "        \n",
    "    # return\n",
    "    return grad_array, grad_mag_array, list(nms)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0408ed99-7b16-45ab-ac5a-32f119973726",
   "metadata": {},
   "outputs": [],
   "source": [
    "def TMAquantification(core_name, data_folder, gradients=True, grad_sigmas=[25]):\n",
    "    # set path to core folder (root_folder below)\n",
    "    core_folder = data_folder.joinpath(f\"{core_name}\")\n",
    "    \n",
    "    # check if segmentation directory exists\n",
    "    _segdir = core_folder.joinpath(\"segmentation/imc/hdiseg-ilastik\")\n",
    "    # check if the registration transformix directory exists\n",
    "    _transdir = core_folder.joinpath(\"registration/msi-imc\")\n",
    "    \n",
    "    # check if segmentation exists\n",
    "    if _segdir.exists():\n",
    "        # set root folder as the core folder\n",
    "        root_folder = core_folder\n",
    "        # set path to segmentation mask\n",
    "        masks = [ core_folder.joinpath(f\"segmentation/imc/hdiseg-ilastik/{core_name}_core_probabilities_mask.tiff\") ]\n",
    "        # set path to imc preprocessed image to quantify\n",
    "        imcIm = core_folder.joinpath(f\"preprocessing/imc/{core_name}_core.ome.tiff\")\n",
    "        \n",
    "        # add to list of images\n",
    "        imagesList = [ imcIm ]\n",
    "        # create markers list\n",
    "        channelsList = [ data_folder.joinpath(\"imc-markers.csv\") ]\n",
    "        # create names list\n",
    "        namesList = [ \"imc\" ]\n",
    "\n",
    "        # create list to store gradient magnitude images in\n",
    "        grad_mags_list = []\n",
    "        # check if multimodal registered data exists\n",
    "        if _transdir.exists():\n",
    "            # set path to imc preprocessed image to quantify\n",
    "            msiIm = root_folder.joinpath(f\"registration/msi-imc/transformix/{core_name}_result.nii\")        \n",
    "            \n",
    "            # update list with the msi data\n",
    "            imagesList.append(msiIm)\n",
    "            # update markers list\n",
    "            channelsList.append(data_folder.joinpath(\"msi-markers.csv\"))\n",
    "            # update names list\n",
    "            namesList.append(\"msi\")\n",
    "\n",
    "            # check if computing gradients\n",
    "            if gradients:\n",
    "                # read the registered msi data\n",
    "                msiIm = _import.HDIreader(\n",
    "                    path_to_data=msiIm,\n",
    "                    path_to_markers=None,\n",
    "                    flatten=False,\n",
    "                    subsample=False,\n",
    "                    method=None,\n",
    "                    mask=None,\n",
    "                    save_mem=False,\n",
    "                    data=None,\n",
    "                    image=None,\n",
    "                    channels=None,\n",
    "                    filename=None)\n",
    "                # iterate over sigmas\n",
    "                for s in grad_sigmas:\n",
    "                    # compute gradients\n",
    "                    grads, grad_magnitudes, _ = per_channel_sobel(\n",
    "                        msiIm.hdi.data.image, \n",
    "                        nms=range(msiIm.hdi.data.image.shape[2]), \n",
    "                        sigma=s)\n",
    "                    # create name for exporting gradint magnitudes\n",
    "                    msiImGrad = root_folder.joinpath(f\"registration/msi-imc/transformix/{core_name}_result_gradient_magnitude_{str(s)}.nii\") \n",
    "                    # create nifti image\n",
    "                    arr = nib.Nifti1Image(grad_magnitudes.transpose(1, 0, 2), affine=np.eye(4))\n",
    "                    # export gradients\n",
    "                    nib.save(arr,str(msiImGrad))\n",
    "                    # update list with the msi data\n",
    "                    imagesList.append(msiImGrad)\n",
    "                    # update markers list\n",
    "                    channelsList.append(data_folder.joinpath(\"msi-markers.csv\"))\n",
    "                    # update names list\n",
    "                    namesList.append(f\"msi-gradient-magnitude-sigma-{str(s)}\")\n",
    "                    # update list of gradient magnitude images\n",
    "                    grad_mags_list.append(msiImGrad)\n",
    "\n",
    "        # create quantification instance\n",
    "        quantifier = HDIquantification(root_folder=root_folder,\n",
    "                    masks=masks,\n",
    "                    images=imagesList,       \n",
    "                    channel_names=channelsList,\n",
    "                    names=namesList,\n",
    "                    probabilities_method=\"ilastik\",\n",
    "                    segmentation_method=\"hdiseg\",\n",
    "                    mask_props=None,\n",
    "                    intensity_props=[\"intensity_mean\"])\n",
    "        # quantify\n",
    "        quantifier.Quantify()\n",
    "        # export documentation\n",
    "        quantifier.QC()\n",
    "        \n",
    "        # remove the gradient images for storage space\n",
    "        if len(grad_mags_list)>0:\n",
    "            for z in grad_mags_list:\n",
    "                z.unlink(missing_ok=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "1f79306d-ec07-4347-860f-75eb5dfd1715",
   "metadata": {
    "collapsed": true,
    "jupyter": {
     "outputs_hidden": true
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "NUMBER OF MASS CYTOMETRY CORES: 61\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [23:33<00:00,  2.01s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001/preprocessing/imc/ROI010_PROSTATE_TMA001_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI010_PROSTATE_TMA001_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001/registration/msi-imc/transformix/ROI010_PROSTATE_TMA001_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI010_PROSTATE_TMA001_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001/registration/msi-imc/transformix/ROI010_PROSTATE_TMA001_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI010_PROSTATE_TMA001_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI010_PROSTATE_TMA001/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/registration/msi-imc/transformix/ROI011_PROSTATE_TMA002_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:23<00:00,  1.66s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/preprocessing/imc/ROI011_PROSTATE_TMA002_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI011_PROSTATE_TMA002_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/registration/msi-imc/transformix/ROI011_PROSTATE_TMA002_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI011_PROSTATE_TMA002_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/registration/msi-imc/transformix/ROI011_PROSTATE_TMA002_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI011_PROSTATE_TMA002_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI011_PROSTATE_TMA002/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/registration/msi-imc/transformix/ROI012_PROSTATE_TMA003_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:46<00:00,  1.69s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/preprocessing/imc/ROI012_PROSTATE_TMA003_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI012_PROSTATE_TMA003_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/registration/msi-imc/transformix/ROI012_PROSTATE_TMA003_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI012_PROSTATE_TMA003_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/registration/msi-imc/transformix/ROI012_PROSTATE_TMA003_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI012_PROSTATE_TMA003_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI012_PROSTATE_TMA003/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/registration/msi-imc/transformix/ROI013_PROSTATE_TMA004_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [20:15<00:00,  1.73s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/preprocessing/imc/ROI013_PROSTATE_TMA004_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI013_PROSTATE_TMA004_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/registration/msi-imc/transformix/ROI013_PROSTATE_TMA004_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI013_PROSTATE_TMA004_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/registration/msi-imc/transformix/ROI013_PROSTATE_TMA004_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI013_PROSTATE_TMA004_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI013_PROSTATE_TMA004/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/registration/msi-imc/transformix/ROI014_PROSTATE_TMA005_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [20:40<00:00,  1.77s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/preprocessing/imc/ROI014_PROSTATE_TMA005_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI014_PROSTATE_TMA005_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/registration/msi-imc/transformix/ROI014_PROSTATE_TMA005_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI014_PROSTATE_TMA005_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/registration/msi-imc/transformix/ROI014_PROSTATE_TMA005_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI014_PROSTATE_TMA005_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI014_PROSTATE_TMA005/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI015_PROSTATE_TMA006\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI015_PROSTATE_TMA006/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI015_PROSTATE_TMA006/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI015_PROSTATE_TMA006/preprocessing/imc/ROI015_PROSTATE_TMA006_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI015_PROSTATE_TMA006_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI015_PROSTATE_TMA006/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI015_PROSTATE_TMA006/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/registration/msi-imc/transformix/ROI016_PROSTATE_TMA007_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:23<00:00,  1.83s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/preprocessing/imc/ROI016_PROSTATE_TMA007_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI016_PROSTATE_TMA007_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/registration/msi-imc/transformix/ROI016_PROSTATE_TMA007_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI016_PROSTATE_TMA007_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/registration/msi-imc/transformix/ROI016_PROSTATE_TMA007_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI016_PROSTATE_TMA007_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI016_PROSTATE_TMA007/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/registration/msi-imc/transformix/ROI017_PROSTATE_TMA008_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [22:17<00:00,  1.91s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/preprocessing/imc/ROI017_PROSTATE_TMA008_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI017_PROSTATE_TMA008_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/registration/msi-imc/transformix/ROI017_PROSTATE_TMA008_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI017_PROSTATE_TMA008_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/registration/msi-imc/transformix/ROI017_PROSTATE_TMA008_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI017_PROSTATE_TMA008_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI017_PROSTATE_TMA008/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/registration/msi-imc/transformix/ROI018_PROSTATE_TMA009_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:45<00:00,  1.86s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/preprocessing/imc/ROI018_PROSTATE_TMA009_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI018_PROSTATE_TMA009_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/registration/msi-imc/transformix/ROI018_PROSTATE_TMA009_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI018_PROSTATE_TMA009_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/registration/msi-imc/transformix/ROI018_PROSTATE_TMA009_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI018_PROSTATE_TMA009_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI018_PROSTATE_TMA009/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/registration/msi-imc/transformix/ROI019_PROSTATE_Benign_TMA008N_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [22:02<00:00,  1.88s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Creating directories for quantification export\n",
      "Creating directories for quantification export\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/preprocessing/imc/ROI019_PROSTATE_Benign_TMA008N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI019_PROSTATE_Benign_TMA008N_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/registration/msi-imc/transformix/ROI019_PROSTATE_Benign_TMA008N_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI019_PROSTATE_Benign_TMA008N_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/registration/msi-imc/transformix/ROI019_PROSTATE_Benign_TMA008N_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI019_PROSTATE_Benign_TMA008N_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI019_PROSTATE_Benign_TMA008N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/registration/msi-imc/transformix/ROI020_PROSTATE_Benign_TMA011N_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [20:23<00:00,  1.74s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Creating directories for quantification export\n",
      "Creating directories for quantification export\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/preprocessing/imc/ROI020_PROSTATE_Benign_TMA011N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI020_PROSTATE_Benign_TMA011N_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/registration/msi-imc/transformix/ROI020_PROSTATE_Benign_TMA011N_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI020_PROSTATE_Benign_TMA011N_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/registration/msi-imc/transformix/ROI020_PROSTATE_Benign_TMA011N_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI020_PROSTATE_Benign_TMA011N_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI020_PROSTATE_Benign_TMA011N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/registration/msi-imc/transformix/ROI021_PROSTATE_TMA012_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:23<00:00,  1.83s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/preprocessing/imc/ROI021_PROSTATE_TMA012_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI021_PROSTATE_TMA012_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/registration/msi-imc/transformix/ROI021_PROSTATE_TMA012_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI021_PROSTATE_TMA012_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/registration/msi-imc/transformix/ROI021_PROSTATE_TMA012_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI021_PROSTATE_TMA012_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI021_PROSTATE_TMA012/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/registration/msi-imc/transformix/ROI022_PROSTATE_TMA013_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:21<00:00,  1.83s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/preprocessing/imc/ROI022_PROSTATE_TMA013_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI022_PROSTATE_TMA013_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/registration/msi-imc/transformix/ROI022_PROSTATE_TMA013_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI022_PROSTATE_TMA013_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/registration/msi-imc/transformix/ROI022_PROSTATE_TMA013_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI022_PROSTATE_TMA013_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI022_PROSTATE_TMA013/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/registration/msi-imc/transformix/ROI023_PROSTATE_TMA015_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [23:25<00:00,  2.00s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/preprocessing/imc/ROI023_PROSTATE_TMA015_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI023_PROSTATE_TMA015_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/registration/msi-imc/transformix/ROI023_PROSTATE_TMA015_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI023_PROSTATE_TMA015_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/registration/msi-imc/transformix/ROI023_PROSTATE_TMA015_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI023_PROSTATE_TMA015_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI023_PROSTATE_TMA015/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/registration/msi-imc/transformix/ROI024_PROSTATE_TMA016_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:34<00:00,  1.84s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/preprocessing/imc/ROI024_PROSTATE_TMA016_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI024_PROSTATE_TMA016_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/registration/msi-imc/transformix/ROI024_PROSTATE_TMA016_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI024_PROSTATE_TMA016_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/registration/msi-imc/transformix/ROI024_PROSTATE_TMA016_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI024_PROSTATE_TMA016_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI024_PROSTATE_TMA016/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/registration/msi-imc/transformix/ROI025_PROSTATE_TMA017_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [20:50<00:00,  1.78s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/preprocessing/imc/ROI025_PROSTATE_TMA017_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI025_PROSTATE_TMA017_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/registration/msi-imc/transformix/ROI025_PROSTATE_TMA017_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI025_PROSTATE_TMA017_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/registration/msi-imc/transformix/ROI025_PROSTATE_TMA017_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI025_PROSTATE_TMA017_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI025_PROSTATE_TMA017/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI026_PROSTATE_TMA018\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI026_PROSTATE_TMA018/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI026_PROSTATE_TMA018/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI026_PROSTATE_TMA018/preprocessing/imc/ROI026_PROSTATE_TMA018_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI026_PROSTATE_TMA018_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI026_PROSTATE_TMA018/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI026_PROSTATE_TMA018/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/registration/msi-imc/transformix/ROI027_PROSTATE_TMA019_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [20:26<00:00,  1.75s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/preprocessing/imc/ROI027_PROSTATE_TMA019_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI027_PROSTATE_TMA019_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/registration/msi-imc/transformix/ROI027_PROSTATE_TMA019_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI027_PROSTATE_TMA019_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/registration/msi-imc/transformix/ROI027_PROSTATE_TMA019_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI027_PROSTATE_TMA019_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI027_PROSTATE_TMA019/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/registration/msi-imc/transformix/ROI028_PROSTATE_TMA020_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [20:59<00:00,  1.79s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/preprocessing/imc/ROI028_PROSTATE_TMA020_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI028_PROSTATE_TMA020_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/registration/msi-imc/transformix/ROI028_PROSTATE_TMA020_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI028_PROSTATE_TMA020_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/registration/msi-imc/transformix/ROI028_PROSTATE_TMA020_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI028_PROSTATE_TMA020_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI028_PROSTATE_TMA020/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/registration/msi-imc/transformix/ROI029_PROSTATE_TMA022_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [22:03<00:00,  1.89s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/preprocessing/imc/ROI029_PROSTATE_TMA022_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI029_PROSTATE_TMA022_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/registration/msi-imc/transformix/ROI029_PROSTATE_TMA022_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI029_PROSTATE_TMA022_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/registration/msi-imc/transformix/ROI029_PROSTATE_TMA022_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI029_PROSTATE_TMA022_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI029_PROSTATE_TMA022/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/registration/msi-imc/transformix/ROI030_PROSTATE_TMA023_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [22:13<00:00,  1.90s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/preprocessing/imc/ROI030_PROSTATE_TMA023_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI030_PROSTATE_TMA023_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/registration/msi-imc/transformix/ROI030_PROSTATE_TMA023_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI030_PROSTATE_TMA023_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/registration/msi-imc/transformix/ROI030_PROSTATE_TMA023_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI030_PROSTATE_TMA023_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI030_PROSTATE_TMA023/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/registration/msi-imc/transformix/ROI031_PROSTATE_TMA024_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:49<00:00,  1.69s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/preprocessing/imc/ROI031_PROSTATE_TMA024_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI031_PROSTATE_TMA024_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/registration/msi-imc/transformix/ROI031_PROSTATE_TMA024_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI031_PROSTATE_TMA024_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/registration/msi-imc/transformix/ROI031_PROSTATE_TMA024_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI031_PROSTATE_TMA024_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI031_PROSTATE_TMA024/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/registration/msi-imc/transformix/ROI032_PROSTATE_TMA025_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:41<00:00,  1.85s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/preprocessing/imc/ROI032_PROSTATE_TMA025_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI032_PROSTATE_TMA025_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/registration/msi-imc/transformix/ROI032_PROSTATE_TMA025_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI032_PROSTATE_TMA025_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/registration/msi-imc/transformix/ROI032_PROSTATE_TMA025_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI032_PROSTATE_TMA025_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI032_PROSTATE_TMA025/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/registration/msi-imc/transformix/ROI033_PROSTATE_TMA026_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [18:44<00:00,  1.60s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/preprocessing/imc/ROI033_PROSTATE_TMA026_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI033_PROSTATE_TMA026_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/registration/msi-imc/transformix/ROI033_PROSTATE_TMA026_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI033_PROSTATE_TMA026_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/registration/msi-imc/transformix/ROI033_PROSTATE_TMA026_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI033_PROSTATE_TMA026_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI033_PROSTATE_TMA026/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI034_PROSTATE_TMA027\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI034_PROSTATE_TMA027/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI034_PROSTATE_TMA027/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI034_PROSTATE_TMA027/preprocessing/imc/ROI034_PROSTATE_TMA027_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI034_PROSTATE_TMA027_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI034_PROSTATE_TMA027/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI034_PROSTATE_TMA027/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI035_PROSTATE_Benign_TMA027N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI035_PROSTATE_Benign_TMA027N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI035_PROSTATE_Benign_TMA027N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI035_PROSTATE_Benign_TMA027N/preprocessing/imc/ROI035_PROSTATE_Benign_TMA027N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI035_PROSTATE_Benign_TMA027N_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI035_PROSTATE_Benign_TMA027N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI035_PROSTATE_Benign_TMA027N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI036_PROSTATE_Benign_TMA028N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI036_PROSTATE_Benign_TMA028N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI036_PROSTATE_Benign_TMA028N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI036_PROSTATE_Benign_TMA028N/preprocessing/imc/ROI036_PROSTATE_Benign_TMA028N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI036_PROSTATE_Benign_TMA028N_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI036_PROSTATE_Benign_TMA028N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI036_PROSTATE_Benign_TMA028N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/registration/msi-imc/transformix/ROI037_PROSTATE_TMA028_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:02<00:00,  1.80s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/preprocessing/imc/ROI037_PROSTATE_TMA028_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI037_PROSTATE_TMA028_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/registration/msi-imc/transformix/ROI037_PROSTATE_TMA028_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI037_PROSTATE_TMA028_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/registration/msi-imc/transformix/ROI037_PROSTATE_TMA028_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI037_PROSTATE_TMA028_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI037_PROSTATE_TMA028/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/registration/msi-imc/transformix/ROI038_PROSTATE_TMA030_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:48<00:00,  1.69s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/preprocessing/imc/ROI038_PROSTATE_TMA030_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI038_PROSTATE_TMA030_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/registration/msi-imc/transformix/ROI038_PROSTATE_TMA030_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI038_PROSTATE_TMA030_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/registration/msi-imc/transformix/ROI038_PROSTATE_TMA030_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI038_PROSTATE_TMA030_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI038_PROSTATE_TMA030/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI039_PROSTATE_TMA031\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI039_PROSTATE_TMA031/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI039_PROSTATE_TMA031/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI039_PROSTATE_TMA031/preprocessing/imc/ROI039_PROSTATE_TMA031_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI039_PROSTATE_TMA031_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI039_PROSTATE_TMA031/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI039_PROSTATE_TMA031/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/registration/msi-imc/transformix/ROI040_PROSTATE_TMA032_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [22:18<00:00,  1.91s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/preprocessing/imc/ROI040_PROSTATE_TMA032_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI040_PROSTATE_TMA032_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/registration/msi-imc/transformix/ROI040_PROSTATE_TMA032_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI040_PROSTATE_TMA032_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/registration/msi-imc/transformix/ROI040_PROSTATE_TMA032_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI040_PROSTATE_TMA032_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI040_PROSTATE_TMA032/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI041_PROSTATE_TMA033\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI041_PROSTATE_TMA033/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI041_PROSTATE_TMA033/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI041_PROSTATE_TMA033/preprocessing/imc/ROI041_PROSTATE_TMA033_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI041_PROSTATE_TMA033_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI041_PROSTATE_TMA033/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI041_PROSTATE_TMA033/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI042_PROSTATE_TMA034\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI042_PROSTATE_TMA034/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI042_PROSTATE_TMA034/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI042_PROSTATE_TMA034/preprocessing/imc/ROI042_PROSTATE_TMA034_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI042_PROSTATE_TMA034_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI042_PROSTATE_TMA034/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI042_PROSTATE_TMA034/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/registration/msi-imc/transformix/ROI043_PROSTATE_TMA035_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:18<00:00,  1.65s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/preprocessing/imc/ROI043_PROSTATE_TMA035_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI043_PROSTATE_TMA035_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/registration/msi-imc/transformix/ROI043_PROSTATE_TMA035_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI043_PROSTATE_TMA035_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/registration/msi-imc/transformix/ROI043_PROSTATE_TMA035_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI043_PROSTATE_TMA035_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI043_PROSTATE_TMA035/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI044_PROSTATE_TMA036\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI044_PROSTATE_TMA036/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI044_PROSTATE_TMA036/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI044_PROSTATE_TMA036/preprocessing/imc/ROI044_PROSTATE_TMA036_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI044_PROSTATE_TMA036_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI044_PROSTATE_TMA036/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI044_PROSTATE_TMA036/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/registration/msi-imc/transformix/ROI045_PROSTATE_TMA038_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [24:46<00:00,  2.12s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/preprocessing/imc/ROI045_PROSTATE_TMA038_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI045_PROSTATE_TMA038_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/registration/msi-imc/transformix/ROI045_PROSTATE_TMA038_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI045_PROSTATE_TMA038_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/registration/msi-imc/transformix/ROI045_PROSTATE_TMA038_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI045_PROSTATE_TMA038_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI045_PROSTATE_TMA038/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI046_PROSTATE_TMA039\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI046_PROSTATE_TMA039/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI046_PROSTATE_TMA039/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI046_PROSTATE_TMA039/preprocessing/imc/ROI046_PROSTATE_TMA039_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI046_PROSTATE_TMA039_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI046_PROSTATE_TMA039/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI046_PROSTATE_TMA039/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI047_PROSTATE_TMA041\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI047_PROSTATE_TMA041/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI047_PROSTATE_TMA041/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI047_PROSTATE_TMA041/preprocessing/imc/ROI047_PROSTATE_TMA041_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI047_PROSTATE_TMA041_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI047_PROSTATE_TMA041/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI047_PROSTATE_TMA041/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/registration/msi-imc/transformix/ROI048_PROSTATE_TMA042_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [18:50<00:00,  1.61s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/preprocessing/imc/ROI048_PROSTATE_TMA042_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI048_PROSTATE_TMA042_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/registration/msi-imc/transformix/ROI048_PROSTATE_TMA042_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI048_PROSTATE_TMA042_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/registration/msi-imc/transformix/ROI048_PROSTATE_TMA042_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI048_PROSTATE_TMA042_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI048_PROSTATE_TMA042/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/registration/msi-imc/transformix/ROI049_PROSTATE_TMA044_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [18:56<00:00,  1.62s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/preprocessing/imc/ROI049_PROSTATE_TMA044_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI049_PROSTATE_TMA044_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/registration/msi-imc/transformix/ROI049_PROSTATE_TMA044_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI049_PROSTATE_TMA044_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/registration/msi-imc/transformix/ROI049_PROSTATE_TMA044_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI049_PROSTATE_TMA044_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI049_PROSTATE_TMA044/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/registration/msi-imc/transformix/ROI050_PROSTATE_TMA045_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [23:09<00:00,  1.98s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/preprocessing/imc/ROI050_PROSTATE_TMA045_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI050_PROSTATE_TMA045_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/registration/msi-imc/transformix/ROI050_PROSTATE_TMA045_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI050_PROSTATE_TMA045_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/registration/msi-imc/transformix/ROI050_PROSTATE_TMA045_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI050_PROSTATE_TMA045_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI050_PROSTATE_TMA045/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/registration/msi-imc/transformix/ROI051_PROSTATE_Benign_TMA043N_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [16:42<00:00,  1.43s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Creating directories for quantification export\n",
      "Creating directories for quantification export\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/preprocessing/imc/ROI051_PROSTATE_Benign_TMA043N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI051_PROSTATE_Benign_TMA043N_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/registration/msi-imc/transformix/ROI051_PROSTATE_Benign_TMA043N_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI051_PROSTATE_Benign_TMA043N_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/registration/msi-imc/transformix/ROI051_PROSTATE_Benign_TMA043N_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI051_PROSTATE_Benign_TMA043N_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI051_PROSTATE_Benign_TMA043N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/registration/msi-imc/transformix/ROI052_PROSTATE_Benign_TMA046N_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:43<00:00,  1.69s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Creating directories for quantification export\n",
      "Creating directories for quantification export\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/preprocessing/imc/ROI052_PROSTATE_Benign_TMA046N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI052_PROSTATE_Benign_TMA046N_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/registration/msi-imc/transformix/ROI052_PROSTATE_Benign_TMA046N_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI052_PROSTATE_Benign_TMA046N_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/registration/msi-imc/transformix/ROI052_PROSTATE_Benign_TMA046N_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI052_PROSTATE_Benign_TMA046N_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI052_PROSTATE_Benign_TMA046N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI053_PROSTATE_TMA046\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI053_PROSTATE_TMA046/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI053_PROSTATE_TMA046/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI053_PROSTATE_TMA046/preprocessing/imc/ROI053_PROSTATE_TMA046_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI053_PROSTATE_TMA046_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI053_PROSTATE_TMA046/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI053_PROSTATE_TMA046/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/registration/msi-imc/transformix/ROI054_PROSTATE_TMA048_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [21:12<00:00,  1.81s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/preprocessing/imc/ROI054_PROSTATE_TMA048_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI054_PROSTATE_TMA048_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/registration/msi-imc/transformix/ROI054_PROSTATE_TMA048_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI054_PROSTATE_TMA048_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/registration/msi-imc/transformix/ROI054_PROSTATE_TMA048_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI054_PROSTATE_TMA048_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI054_PROSTATE_TMA048/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/registration/msi-imc/transformix/ROI055_PROSTATE_TMA049_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [15:24<00:00,  1.32s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/preprocessing/imc/ROI055_PROSTATE_TMA049_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI055_PROSTATE_TMA049_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/registration/msi-imc/transformix/ROI055_PROSTATE_TMA049_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI055_PROSTATE_TMA049_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/registration/msi-imc/transformix/ROI055_PROSTATE_TMA049_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI055_PROSTATE_TMA049_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI055_PROSTATE_TMA049/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI056_PROSTATE_TMA054\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI056_PROSTATE_TMA054/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI056_PROSTATE_TMA054/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI056_PROSTATE_TMA054/preprocessing/imc/ROI056_PROSTATE_TMA054_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI056_PROSTATE_TMA054_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI056_PROSTATE_TMA054/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI056_PROSTATE_TMA054/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI057_PROSTATE_TMA055\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI057_PROSTATE_TMA055/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI057_PROSTATE_TMA055/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI057_PROSTATE_TMA055/preprocessing/imc/ROI057_PROSTATE_TMA055_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI057_PROSTATE_TMA055_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI057_PROSTATE_TMA055/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI057_PROSTATE_TMA055/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI058_PROSTATE_TMA056\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI058_PROSTATE_TMA056/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI058_PROSTATE_TMA056/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI058_PROSTATE_TMA056/preprocessing/imc/ROI058_PROSTATE_TMA056_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI058_PROSTATE_TMA056_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI058_PROSTATE_TMA056/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI058_PROSTATE_TMA056/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI059_PROSTATE_TMA057\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI059_PROSTATE_TMA057/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI059_PROSTATE_TMA057/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI059_PROSTATE_TMA057/preprocessing/imc/ROI059_PROSTATE_TMA057_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI059_PROSTATE_TMA057_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI059_PROSTATE_TMA057/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI059_PROSTATE_TMA057/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI060_PROSTATE_TMA059\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI060_PROSTATE_TMA059/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI060_PROSTATE_TMA059/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI060_PROSTATE_TMA059/preprocessing/imc/ROI060_PROSTATE_TMA059_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI060_PROSTATE_TMA059_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI060_PROSTATE_TMA059/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI060_PROSTATE_TMA059/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/registration/msi-imc/transformix/ROI061_PROSTATE_TMA060_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:03<00:00,  1.63s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/preprocessing/imc/ROI061_PROSTATE_TMA060_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI061_PROSTATE_TMA060_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/registration/msi-imc/transformix/ROI061_PROSTATE_TMA060_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI061_PROSTATE_TMA060_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/registration/msi-imc/transformix/ROI061_PROSTATE_TMA060_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI061_PROSTATE_TMA060_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI061_PROSTATE_TMA060/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/registration/msi-imc/transformix/ROI062_PROSTATE_TMA061_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [20:50<00:00,  1.78s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/preprocessing/imc/ROI062_PROSTATE_TMA061_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI062_PROSTATE_TMA061_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/registration/msi-imc/transformix/ROI062_PROSTATE_TMA061_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI062_PROSTATE_TMA061_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/registration/msi-imc/transformix/ROI062_PROSTATE_TMA061_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI062_PROSTATE_TMA061_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI062_PROSTATE_TMA061/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI063_PROSTATE_TMA062\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI063_PROSTATE_TMA062/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI063_PROSTATE_TMA062/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI063_PROSTATE_TMA062/preprocessing/imc/ROI063_PROSTATE_TMA062_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI063_PROSTATE_TMA062_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI063_PROSTATE_TMA062/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI063_PROSTATE_TMA062/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/registration/msi-imc/transformix/ROI064_PROSTATE_Benign_TMA063N_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [18:16<00:00,  1.56s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Creating directories for quantification export\n",
      "Creating directories for quantification export\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/preprocessing/imc/ROI064_PROSTATE_Benign_TMA063N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI064_PROSTATE_Benign_TMA063N_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/registration/msi-imc/transformix/ROI064_PROSTATE_Benign_TMA063N_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI064_PROSTATE_Benign_TMA063N_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/registration/msi-imc/transformix/ROI064_PROSTATE_Benign_TMA063N_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI064_PROSTATE_Benign_TMA063N_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI064_PROSTATE_Benign_TMA063N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI065_PROSTATE_Benign_TMA064N\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI065_PROSTATE_Benign_TMA064N/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI065_PROSTATE_Benign_TMA064N/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI065_PROSTATE_Benign_TMA064N/preprocessing/imc/ROI065_PROSTATE_Benign_TMA064N_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI065_PROSTATE_Benign_TMA064N_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI065_PROSTATE_Benign_TMA064N/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI065_PROSTATE_Benign_TMA064N/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI066_PROSTATE_TMA064\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI066_PROSTATE_TMA064/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI066_PROSTATE_TMA064/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI066_PROSTATE_TMA064/preprocessing/imc/ROI066_PROSTATE_TMA064_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI066_PROSTATE_TMA064_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI066_PROSTATE_TMA064/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI066_PROSTATE_TMA064/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI067_PROSTATE_TMA065\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI067_PROSTATE_TMA065/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI067_PROSTATE_TMA065/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI067_PROSTATE_TMA065/preprocessing/imc/ROI067_PROSTATE_TMA065_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI067_PROSTATE_TMA065_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI067_PROSTATE_TMA065/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI067_PROSTATE_TMA065/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "INFO:root:Valid path...\n",
      "INFO:root:Valid file extension...\n",
      "INFO:root:file name: /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/registration/msi-imc/transformix/ROI068_PROSTATE_TMA066_result.nii\n",
      "INFO:root:Finished parsing nifti\n",
      "INFO:root:Finished\n",
      "Computing image gradients: 100%|██████████████████████████████████████████████████████| 702/702 [19:27<00:00,  1.66s/it]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/preprocessing/imc/ROI068_PROSTATE_TMA066_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI068_PROSTATE_TMA066_core\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/registration/msi-imc/transformix/ROI068_PROSTATE_TMA066_result.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI068_PROSTATE_TMA066_result\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/registration/msi-imc/transformix/ROI068_PROSTATE_TMA066_result_gradient_magnitude_25.nii...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished 62\n",
      "Finished 63\n",
      "Finished 64\n",
      "Finished 65\n",
      "Finished 66\n",
      "Finished 67\n",
      "Finished 68\n",
      "Finished 69\n",
      "Finished 70\n",
      "Finished 71\n",
      "Finished 72\n",
      "Finished 73\n",
      "Finished 74\n",
      "Finished 75\n",
      "Finished 76\n",
      "Finished 77\n",
      "Finished 78\n",
      "Finished 79\n",
      "Finished 80\n",
      "Finished 81\n",
      "Finished 82\n",
      "Finished 83\n",
      "Finished 84\n",
      "Finished 85\n",
      "Finished 86\n",
      "Finished 87\n",
      "Finished 88\n",
      "Finished 89\n",
      "Finished 90\n",
      "Finished 91\n",
      "Finished 92\n",
      "Finished 93\n",
      "Finished 94\n",
      "Finished 95\n",
      "Finished 96\n",
      "Finished 97\n",
      "Finished 98\n",
      "Finished 99\n",
      "Finished 100\n",
      "Finished 101\n",
      "Finished 102\n",
      "Finished 103\n",
      "Finished 104\n",
      "Finished 105\n",
      "Finished 106\n",
      "Finished 107\n",
      "Finished 108\n",
      "Finished 109\n",
      "Finished 110\n",
      "Finished 111\n",
      "Finished 112\n",
      "Finished 113\n",
      "Finished 114\n",
      "Finished 115\n",
      "Finished 116\n",
      "Finished 117\n",
      "Finished 118\n",
      "Finished 119\n",
      "Finished 120\n",
      "Finished 121\n",
      "Finished 122\n",
      "Finished 123\n",
      "Finished 124\n",
      "Finished 125\n",
      "Finished 126\n",
      "Finished 127\n",
      "Finished 128\n",
      "Finished 129\n",
      "Finished 130\n",
      "Finished 131\n",
      "Finished 132\n",
      "Finished 133\n",
      "Finished 134\n",
      "Finished 135\n",
      "Finished 136\n",
      "Finished 137\n",
      "Finished 138\n",
      "Finished 139\n",
      "Finished 140\n",
      "Finished 141\n",
      "Finished 142\n",
      "Finished 143\n",
      "Finished 144\n",
      "Finished 145\n",
      "Finished 146\n",
      "Finished 147\n",
      "Finished 148\n",
      "Finished 149\n",
      "Finished 150\n",
      "Finished 151\n",
      "Finished 152\n",
      "Finished 153\n",
      "Finished 154\n",
      "Finished 155\n",
      "Finished 156\n",
      "Finished 157\n",
      "Finished 158\n",
      "Finished 159\n",
      "Finished 160\n",
      "Finished 161\n",
      "Finished 162\n",
      "Finished 163\n",
      "Finished 164\n",
      "Finished 165\n",
      "Finished 166\n",
      "Finished 167\n",
      "Finished 168\n",
      "Finished 169\n",
      "Finished 170\n",
      "Finished 171\n",
      "Finished 172\n",
      "Finished 173\n",
      "Finished 174\n",
      "Finished 175\n",
      "Finished 176\n",
      "Finished 177\n",
      "Finished 178\n",
      "Finished 179\n",
      "Finished 180\n",
      "Finished 181\n",
      "Finished 182\n",
      "Finished 183\n",
      "Finished 184\n",
      "Finished 185\n",
      "Finished 186\n",
      "Finished 187\n",
      "Finished 188\n",
      "Finished 189\n",
      "Finished 190\n",
      "Finished 191\n",
      "Finished 192\n",
      "Finished 193\n",
      "Finished 194\n",
      "Finished 195\n",
      "Finished 196\n",
      "Finished 197\n",
      "Finished 198\n",
      "Finished 199\n",
      "Finished 200\n",
      "Finished 201\n",
      "Finished 202\n",
      "Finished 203\n",
      "Finished 204\n",
      "Finished 205\n",
      "Finished 206\n",
      "Finished 207\n",
      "Finished 208\n",
      "Finished 209\n",
      "Finished 210\n",
      "Finished 211\n",
      "Finished 212\n",
      "Finished 213\n",
      "Finished 214\n",
      "Finished 215\n",
      "Finished 216\n",
      "Finished 217\n",
      "Finished 218\n",
      "Finished 219\n",
      "Finished 220\n",
      "Finished 221\n",
      "Finished 222\n",
      "Finished 223\n",
      "Finished 224\n",
      "Finished 225\n",
      "Finished 226\n",
      "Finished 227\n",
      "Finished 228\n",
      "Finished 229\n",
      "Finished 230\n",
      "Finished 231\n",
      "Finished 232\n",
      "Finished 233\n",
      "Finished 234\n",
      "Finished 235\n",
      "Finished 236\n",
      "Finished 237\n",
      "Finished 238\n",
      "Finished 239\n",
      "Finished 240\n",
      "Finished 241\n",
      "Finished 242\n",
      "Finished 243\n",
      "Finished 244\n",
      "Finished 245\n",
      "Finished 246\n",
      "Finished 247\n",
      "Finished 248\n",
      "Finished 249\n",
      "Finished 250\n",
      "Finished 251\n",
      "Finished 252\n",
      "Finished 253\n",
      "Finished 254\n",
      "Finished 255\n",
      "Finished 256\n",
      "Finished 257\n",
      "Finished 258\n",
      "Finished 259\n",
      "Finished 260\n",
      "Finished 261\n",
      "Finished 262\n",
      "Finished 263\n",
      "Finished 264\n",
      "Finished 265\n",
      "Finished 266\n",
      "Finished 267\n",
      "Finished 268\n",
      "Finished 269\n",
      "Finished 270\n",
      "Finished 271\n",
      "Finished 272\n",
      "Finished 273\n",
      "Finished 274\n",
      "Finished 275\n",
      "Finished 276\n",
      "Finished 277\n",
      "Finished 278\n",
      "Finished 279\n",
      "Finished 280\n",
      "Finished 281\n",
      "Finished 282\n",
      "Finished 283\n",
      "Finished 284\n",
      "Finished 285\n",
      "Finished 286\n",
      "Finished 287\n",
      "Finished 288\n",
      "Finished 289\n",
      "Finished 290\n",
      "Finished 291\n",
      "Finished 292\n",
      "Finished 293\n",
      "Finished 294\n",
      "Finished 295\n",
      "Finished 296\n",
      "Finished 297\n",
      "Finished 298\n",
      "Finished 299\n",
      "Finished 300\n",
      "Finished 301\n",
      "Finished 302\n",
      "Finished 303\n",
      "Finished 304\n",
      "Finished 305\n",
      "Finished 306\n",
      "Finished 307\n",
      "Finished 308\n",
      "Finished 309\n",
      "Finished 310\n",
      "Finished 311\n",
      "Finished 312\n",
      "Finished 313\n",
      "Finished 314\n",
      "Finished 315\n",
      "Finished 316\n",
      "Finished 317\n",
      "Finished 318\n",
      "Finished 319\n",
      "Finished 320\n",
      "Finished 321\n",
      "Finished 322\n",
      "Finished 323\n",
      "Finished 324\n",
      "Finished 325\n",
      "Finished 326\n",
      "Finished 327\n",
      "Finished 328\n",
      "Finished 329\n",
      "Finished 330\n",
      "Finished 331\n",
      "Finished 332\n",
      "Finished 333\n",
      "Finished 334\n",
      "Finished 335\n",
      "Finished 336\n",
      "Finished 337\n",
      "Finished 338\n",
      "Finished 339\n",
      "Finished 340\n",
      "Finished 341\n",
      "Finished 342\n",
      "Finished 343\n",
      "Finished 344\n",
      "Finished 345\n",
      "Finished 346\n",
      "Finished 347\n",
      "Finished 348\n",
      "Finished 349\n",
      "Finished 350\n",
      "Finished 351\n",
      "Finished 352\n",
      "Finished 353\n",
      "Finished 354\n",
      "Finished 355\n",
      "Finished 356\n",
      "Finished 357\n",
      "Finished 358\n",
      "Finished 359\n",
      "Finished 360\n",
      "Finished 361\n",
      "Finished 362\n",
      "Finished 363\n",
      "Finished 364\n",
      "Finished 365\n",
      "Finished 366\n",
      "Finished 367\n",
      "Finished 368\n",
      "Finished 369\n",
      "Finished 370\n",
      "Finished 371\n",
      "Finished 372\n",
      "Finished 373\n",
      "Finished 374\n",
      "Finished 375\n",
      "Finished 376\n",
      "Finished 377\n",
      "Finished 378\n",
      "Finished 379\n",
      "Finished 380\n",
      "Finished 381\n",
      "Finished 382\n",
      "Finished 383\n",
      "Finished 384\n",
      "Finished 385\n",
      "Finished 386\n",
      "Finished 387\n",
      "Finished 388\n",
      "Finished 389\n",
      "Finished 390\n",
      "Finished 391\n",
      "Finished 392\n",
      "Finished 393\n",
      "Finished 394\n",
      "Finished 395\n",
      "Finished 396\n",
      "Finished 397\n",
      "Finished 398\n",
      "Finished 399\n",
      "Finished 400\n",
      "Finished 401\n",
      "Finished 402\n",
      "Finished 403\n",
      "Finished 404\n",
      "Finished 405\n",
      "Finished 406\n",
      "Finished 407\n",
      "Finished 408\n",
      "Finished 409\n",
      "Finished 410\n",
      "Finished 411\n",
      "Finished 412\n",
      "Finished 413\n",
      "Finished 414\n",
      "Finished 415\n",
      "Finished 416\n",
      "Finished 417\n",
      "Finished 418\n",
      "Finished 419\n",
      "Finished 420\n",
      "Finished 421\n",
      "Finished 422\n",
      "Finished 423\n",
      "Finished 424\n",
      "Finished 425\n",
      "Finished 426\n",
      "Finished 427\n",
      "Finished 428\n",
      "Finished 429\n",
      "Finished 430\n",
      "Finished 431\n",
      "Finished 432\n",
      "Finished 433\n",
      "Finished 434\n",
      "Finished 435\n",
      "Finished 436\n",
      "Finished 437\n",
      "Finished 438\n",
      "Finished 439\n",
      "Finished 440\n",
      "Finished 441\n",
      "Finished 442\n",
      "Finished 443\n",
      "Finished 444\n",
      "Finished 445\n",
      "Finished 446\n",
      "Finished 447\n",
      "Finished 448\n",
      "Finished 449\n",
      "Finished 450\n",
      "Finished 451\n",
      "Finished 452\n",
      "Finished 453\n",
      "Finished 454\n",
      "Finished 455\n",
      "Finished 456\n",
      "Finished 457\n",
      "Finished 458\n",
      "Finished 459\n",
      "Finished 460\n",
      "Finished 461\n",
      "Finished 462\n",
      "Finished 463\n",
      "Finished 464\n",
      "Finished 465\n",
      "Finished 466\n",
      "Finished 467\n",
      "Finished 468\n",
      "Finished 469\n",
      "Finished 470\n",
      "Finished 471\n",
      "Finished 472\n",
      "Finished 473\n",
      "Finished 474\n",
      "Finished 475\n",
      "Finished 476\n",
      "Finished 477\n",
      "Finished 478\n",
      "Finished 479\n",
      "Finished 480\n",
      "Finished 481\n",
      "Finished 482\n",
      "Finished 483\n",
      "Finished 484\n",
      "Finished 485\n",
      "Finished 486\n",
      "Finished 487\n",
      "Finished 488\n",
      "Finished 489\n",
      "Finished 490\n",
      "Finished 491\n",
      "Finished 492\n",
      "Finished 493\n",
      "Finished 494\n",
      "Finished 495\n",
      "Finished 496\n",
      "Finished 497\n",
      "Finished 498\n",
      "Finished 499\n",
      "Finished 500\n",
      "Finished 501\n",
      "Finished 502\n",
      "Finished 503\n",
      "Finished 504\n",
      "Finished 505\n",
      "Finished 506\n",
      "Finished 507\n",
      "Finished 508\n",
      "Finished 509\n",
      "Finished 510\n",
      "Finished 511\n",
      "Finished 512\n",
      "Finished 513\n",
      "Finished 514\n",
      "Finished 515\n",
      "Finished 516\n",
      "Finished 517\n",
      "Finished 518\n",
      "Finished 519\n",
      "Finished 520\n",
      "Finished 521\n",
      "Finished 522\n",
      "Finished 523\n",
      "Finished 524\n",
      "Finished 525\n",
      "Finished 526\n",
      "Finished 527\n",
      "Finished 528\n",
      "Finished 529\n",
      "Finished 530\n",
      "Finished 531\n",
      "Finished 532\n",
      "Finished 533\n",
      "Finished 534\n",
      "Finished 535\n",
      "Finished 536\n",
      "Finished 537\n",
      "Finished 538\n",
      "Finished 539\n",
      "Finished 540\n",
      "Finished 541\n",
      "Finished 542\n",
      "Finished 543\n",
      "Finished 544\n",
      "Finished 545\n",
      "Finished 546\n",
      "Finished 547\n",
      "Finished 548\n",
      "Finished 549\n",
      "Finished 550\n",
      "Finished 551\n",
      "Finished 552\n",
      "Finished 553\n",
      "Finished 554\n",
      "Finished 555\n",
      "Finished 556\n",
      "Finished 557\n",
      "Finished 558\n",
      "Finished 559\n",
      "Finished 560\n",
      "Finished 561\n",
      "Finished 562\n",
      "Finished 563\n",
      "Finished 564\n",
      "Finished 565\n",
      "Finished 566\n",
      "Finished 567\n",
      "Finished 568\n",
      "Finished 569\n",
      "Finished 570\n",
      "Finished 571\n",
      "Finished 572\n",
      "Finished 573\n",
      "Finished 574\n",
      "Finished 575\n",
      "Finished 576\n",
      "Finished 577\n",
      "Finished 578\n",
      "Finished 579\n",
      "Finished 580\n",
      "Finished 581\n",
      "Finished 582\n",
      "Finished 583\n",
      "Finished 584\n",
      "Finished 585\n",
      "Finished 586\n",
      "Finished 587\n",
      "Finished 588\n",
      "Finished 589\n",
      "Finished 590\n",
      "Finished 591\n",
      "Finished 592\n",
      "Finished 593\n",
      "Finished 594\n",
      "Finished 595\n",
      "Finished 596\n",
      "Finished 597\n",
      "Finished 598\n",
      "Finished 599\n",
      "Finished 600\n",
      "Finished 601\n",
      "Finished 602\n",
      "Finished 603\n",
      "Finished 604\n",
      "Finished 605\n",
      "Finished 606\n",
      "Finished 607\n",
      "Finished 608\n",
      "Finished 609\n",
      "Finished 610\n",
      "Finished 611\n",
      "Finished 612\n",
      "Finished 613\n",
      "Finished 614\n",
      "Finished 615\n",
      "Finished 616\n",
      "Finished 617\n",
      "Finished 618\n",
      "Finished 619\n",
      "Finished 620\n",
      "Finished 621\n",
      "Finished 622\n",
      "Finished 623\n",
      "Finished 624\n",
      "Finished 625\n",
      "Finished 626\n",
      "Finished 627\n",
      "Finished 628\n",
      "Finished 629\n",
      "Finished 630\n",
      "Finished 631\n",
      "Finished 632\n",
      "Finished 633\n",
      "Finished 634\n",
      "Finished 635\n",
      "Finished 636\n",
      "Finished 637\n",
      "Finished 638\n",
      "Finished 639\n",
      "Finished 640\n",
      "Finished 641\n",
      "Finished 642\n",
      "Finished 643\n",
      "Finished 644\n",
      "Finished 645\n",
      "Finished 646\n",
      "Finished 647\n",
      "Finished 648\n",
      "Finished 649\n",
      "Finished 650\n",
      "Finished 651\n",
      "Finished 652\n",
      "Finished 653\n",
      "Finished 654\n",
      "Finished 655\n",
      "Finished 656\n",
      "Finished 657\n",
      "Finished 658\n",
      "Finished 659\n",
      "Finished 660\n",
      "Finished 661\n",
      "Finished 662\n",
      "Finished 663\n",
      "Finished 664\n",
      "Finished 665\n",
      "Finished 666\n",
      "Finished 667\n",
      "Finished 668\n",
      "Finished 669\n",
      "Finished 670\n",
      "Finished 671\n",
      "Finished 672\n",
      "Finished 673\n",
      "Finished 674\n",
      "Finished 675\n",
      "Finished 676\n",
      "Finished 677\n",
      "Finished 678\n",
      "Finished 679\n",
      "Finished 680\n",
      "Finished 681\n",
      "Finished 682\n",
      "Finished 683\n",
      "Finished 684\n",
      "Finished 685\n",
      "Finished 686\n",
      "Finished 687\n",
      "Finished 688\n",
      "Finished 689\n",
      "Finished 690\n",
      "Finished 691\n",
      "Finished 692\n",
      "Finished 693\n",
      "Finished 694\n",
      "Finished 695\n",
      "Finished 696\n",
      "Finished 697\n",
      "Finished 698\n",
      "Finished 699\n",
      "Finished 700\n",
      "Finished 701\n",
      "Finished ROI068_PROSTATE_TMA066_result_gradient_magnitude_25\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI068_PROSTATE_TMA066/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI069_PROSTATE_TMA067\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI069_PROSTATE_TMA067/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI069_PROSTATE_TMA067/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI069_PROSTATE_TMA067/preprocessing/imc/ROI069_PROSTATE_TMA067_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI069_PROSTATE_TMA067_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI069_PROSTATE_TMA067/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI069_PROSTATE_TMA067/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n",
      "MIAAIM QUANTIFICATION\n",
      "MIAAIM VERSION 0.0.2\n",
      "METHOD: HDIquantification\n",
      "ROOT FOLDER: /opt/miaaim-20220912-TMA4/data/ROI070_PROSTATE_TMA070\n",
      "PROVENANCE FOLDER: /opt/miaaim-20220912-TMA4/data/ROI070_PROSTATE_TMA070/docs/provenance\n",
      "QC FOLDER: /opt/miaaim-20220912-TMA4/data/ROI070_PROSTATE_TMA070/docs/qc/quantification/hdiseg-ilastik \n",
      "\n",
      "\n",
      "\n",
      "PROCESSING DATA\n",
      "Quantify: extracting single-cell measurements\n",
      "Extracting single-cell data for /opt/miaaim-20220912-TMA4/data/ROI070_PROSTATE_TMA070/preprocessing/imc/ROI070_PROSTATE_TMA070_core.ome.tiff...\n",
      "Finished 0\n",
      "Finished 1\n",
      "Finished 2\n",
      "Finished 3\n",
      "Finished 4\n",
      "Finished 5\n",
      "Finished 6\n",
      "Finished 7\n",
      "Finished 8\n",
      "Finished 9\n",
      "Finished 10\n",
      "Finished 11\n",
      "Finished 12\n",
      "Finished 13\n",
      "Finished 14\n",
      "Finished 15\n",
      "Finished 16\n",
      "Finished 17\n",
      "Finished 18\n",
      "Finished 19\n",
      "Finished 20\n",
      "Finished 21\n",
      "Finished 22\n",
      "Finished 23\n",
      "Finished 24\n",
      "Finished 25\n",
      "Finished 26\n",
      "Finished 27\n",
      "Finished 28\n",
      "Finished 29\n",
      "Finished 30\n",
      "Finished 31\n",
      "Finished 32\n",
      "Finished 33\n",
      "Finished 34\n",
      "Finished 35\n",
      "Finished 36\n",
      "Finished 37\n",
      "Finished 38\n",
      "Finished 39\n",
      "Finished 40\n",
      "Finished 41\n",
      "Finished 42\n",
      "Finished 43\n",
      "Finished 44\n",
      "Finished 45\n",
      "Finished 46\n",
      "Finished 47\n",
      "Finished 48\n",
      "Finished 49\n",
      "Finished 50\n",
      "Finished 51\n",
      "Finished 52\n",
      "Finished 53\n",
      "Finished 54\n",
      "Finished 55\n",
      "Finished 56\n",
      "Finished 57\n",
      "Finished 58\n",
      "Finished 59\n",
      "Finished 60\n",
      "Finished 61\n",
      "Finished ROI070_PROSTATE_TMA070_core\n",
      "QC: extracting quality control information\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI070_PROSTATE_TMA070/docs/parameters/miaaim-quant-hdiseg-ilastik.yaml\n",
      "Exporting /opt/miaaim-20220912-TMA4/data/ROI070_PROSTATE_TMA070/docs/provenance/miaaim-quant-hdiseg-ilastik.sh\n"
     ]
    }
   ],
   "source": [
    "# set path to data folder\n",
    "data_folder = Path(\"/opt/miaaim-20220912-TMA4/data\")\n",
    "# get list of all core names in the data folder\n",
    "# check to make sure we have the core folders for only prostate samples which have\n",
    "# multimodal data (here, indicated by /registration folder)\n",
    "core_folders = [data_folder.joinpath(c) for c in os.listdir(data_folder) if data_folder.joinpath(c).is_dir()]\n",
    "core_folders = [c for c in core_folders if Path(f\"{c}/probabilities/imc/ilastik\").is_dir()]\n",
    "\n",
    "# print the size of the list of folders\n",
    "print(f\"NUMBER OF MASS CYTOMETRY CORES: {str(len(core_folders))}\")\n",
    "# iterate through data set and register\n",
    "for c in core_folders:\n",
    "    # register\n",
    "    TMAquantification(core_name=c.name, data_folder=data_folder)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
